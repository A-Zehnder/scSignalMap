\name{generate_neo4j_local_load_script}
\alias{generate_neo4j_local_load_script}
\title{Generate Neo4j LOAD CSV script using local files from scSignalMap pipeline}

\description{
  Automatically discovers the CSV files generated by the scSignalMap pipeline in a local directory
  and creates a complete Cypher script for importing the data into a local Neo4j instance using
  \code{file:///} paths.

  The script handles:
  \itemize{
    \item The three core relationship files produced by \code{\link{export_for_neo4j}}
    \item All filtered Enrichr pathway files (ending in \code{_enrichr_results_DATABASE2.csv})
  }
}

\usage{
generate_neo4j_local_load_script(neo4j_dir = "Neo4J/",
                                output_file = file.path(neo4j_dir, "load_scSignalMap_local.cypher"))
}

\arguments{
  \item{neo4j_dir}{
    Directory containing the CSV files generated by the scSignalMap pipeline.
    Default: \code{"Neo4J/"}.
  }
  \item{output_file}{
    Path and filename for the generated Cypher script.
    Default: \code{"Neo4J/load_scSignalMap_local.cypher"} (inside \code{neo4j_dir}).
  }
}

\details{
  The function scans \code{neo4j_dir} for:
  \itemize{
    \item \code{*_senders_ligands.csv}
    \item \code{*_ligands_receptor_pairs.csv}
    \item \code{*_receptors_receivers.csv}
    \item Any number of \code{*_enrichr_results_DATABASE2.csv} files (optional)
  }

  If any of the three core files are missing, the function stops with an error listing found files.

  The generated script includes:
  \itemize{
    \item Index creation for performance
    \item Loading and merging of sender → ligand relationships
    \item Loading and merging of ligand → receptor relationships
    \item Loading and merging of receptor → receiver relationships
    \item Optional loading of filtered pathway enrichment results linked to receivers
  }

  The resulting \code{.cypher} file can be run directly in the Neo4j Browser after copying all CSVs
  to the Neo4j \code{import/} directory.
}

\value{
  Invisibly returns the full path to the generated Cypher script.
}

\examples{
\donttest{
# After running the pipeline and exporting files to "Neo4J/"
generate_neo4j_local_load_script(
  neo4j_dir = "Neo4J/",
  output_file = "Neo4J/my_analysis_local.cypher"
)

# Instructions printed:
# 1. Copy all files from 'Neo4J/' into your Neo4j import/ directory
# 2. Run the generated script in Neo4j Browser
}
}

\seealso{
  \code{\link{generate_neo4j_cloud_load_script}},
  \code{\link{export_for_neo4j}},
  \code{\link{run_post_processing_Neo4J}}
}

\author{
  Plaisier Lab
}

\keyword{Neo4j}
\keyword{import}
\keyword{local}
